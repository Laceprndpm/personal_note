---
title: D. Shuffle
date: 2025-04-17
last_clear: 2025-11-25
tags:
  - edu
  - tag/math/组合数
  - tag/双指针
grasp: 3
value: 2
difficulty: 2000
optional_difficulty:
source: https://codeforces.com/contest/1622/problem/D
article:
---
原先做法失传，现在的方法是对于每个 `00010...01000` 贪心地选择最长的前缀后缀 `0` ，随后为了保证不重复，要求到第一个 `1` 前必须有修改。最后尾判
```cpp showLineNumbers
void solve()
{
    int n, k;
    cin >> n >> k;
    string s;
    cin >> s;
    s = '#' + s;
    vector<int> last(n + 1);
    for (int i = 1; i <= n; i++) {
        if (s[i - 1] == '1') {
            last[i] = i - 1;
        } else {
            last[i] = last[i - 1];
        }
    }
    int i1 = 0, i2 = 1;
    int cnt1 = 0;
    for (i2 = 1; i2 <= n; i2++) {
        if (s[i2] == '1') {
            cnt1++;
            if (cnt1 == k + 1) break;
        }
    }
    Z ans = 0;
    if (cnt1 < k || k == 0) {
        cout << 1 << '\n';
        return;
    }
    for (int i1 = 1; i1 <= n; i1++) {
        if (s[i1] == '1') {
            if (i2 > n) {
                ans += comb.binom(i2 - last[i1] - 1, k) - 1;
                break;
            }
            ans += comb.binom(i2 - last[i1] - 1, k) - comb.binom(i2 - i1 - 1, k - 1);
            for (i2++; i2 <= n; i2++) {
                if (s[i2] == '1') break;
            }
        }
    }
    ans += 1;
    cout << ans << '\n';
}
```
