杜教筛：
$$
\begin{align}
M(n) &= \sum_{i=1}^{n} \mu(i) \\
M(n) &= 1 - \sum_{i=2}^{n} M\left(\left\lfloor \frac{n}{i} \right\rfloor\right) \\
\end{align}
$$
$$
T(n) = T(\frac{n}{2}) + T(\frac{n}{3}) + \dots + T(1)
$$
约 $O(n^{\frac{3}{4}})$ ，若预处理前 $n^{\frac{2}{3}}$ 内容，则降到 $O(n^{\frac{2}{3}})$ 

常见公式:
$$
\sum_{A_1=1}^n \sum_{A_2=1}^n \dots \sum_{A_k=1}^n [\gcd(A_1,A_2\dots A_k) = 1] = \sum_{d=1}^n\mu(d)\left\lfloor\frac{n}{d}\right\rfloor^{k}
$$
$$
\begin{align}
f(d) &= \sum_{A_1=1}^n \sum_{A_2=1}^n \dots \sum_{A_k=1}^n [\gcd(A_1,A_2\dots A_k) = d] \\
g(d) &= \sum_{d|d'} f(d') = \left\lfloor \frac{n}{d} \right\rfloor^{k} \\
f(d) &= \sum_{d|d'} \mu(\frac{d'}{d}) \cdot g(d') \\
f(1) &= \sum_{i = 1} \mu(i) \cdot g(i) \\
&= \sum_{d=1}^n\mu(d)\left\lfloor\frac{n}{d}\right\rfloor^{k}
\end{align}
$$
莫比乌斯反演存在偏序集上的推广。可以用于理解。
$$
g(x) = \sum_{y \le x} f(y) \quad \forall x \in P
$$
$$
f(x) = \sum_{y \le x} \mu(y, x) \cdot g(y)
$$
听说过Min-Max容斥

# E6

矩阵加速递推：
## 1.
$$
f(n) = a_1f(n-1) + a_2f(n - 2) \dots a_kf(n - k)
$$
则：
$$
F(n) = 
\begin{bmatrix}
f(n) \\
f(n-1) \\
\vdots \\
f(n-k+1)
\end{bmatrix}
$$

$$
\begin{bmatrix}
f(n) \\
f(n-1) \\
f(n-2) \\
\vdots \\
f(n-k+1)
\end{bmatrix}
 =
\begin{bmatrix}
a_1 & a_2 & \cdots & a_{k-1} & a_k \\
1 & 0 & \cdots & 0 & 0 \\
0 & 1 & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & 1 & 0 \\
\end{bmatrix}
\begin{bmatrix}
f(n-1) \\
f(n-2) \\
f(n-3) \\
\vdots \\
f(n-k)
\end{bmatrix}
$$
$$
F(n) = T \cdot F(n-1)
$$


## 2.
$$
f(n) = a_1f(n-1) + \dots + a_kf(n-k) + C
$$
$$
\begin{bmatrix}
f(n) \\
f(n-1) \\
\vdots \\
f(n-k+1) \\
C
\end{bmatrix}
 =
\begin{bmatrix}
a_1 & \cdots & a_{k-1} & a_k & 1 \\
1 & \cdots & 0 & 0 & 0 \\
\vdots & \ddots & \vdots & \vdots & \vdots \\
0 & \cdots & 1 & 0 & 0 \\
0 & \cdots & 0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
f(n-1) \\
f(n-2) \\
\vdots \\
f(n-k) \\
C
\end{bmatrix}
$$
## 3.
$$
f(n) = a_1f(n-1) + \dots + a_kf(n-k) + c_2 \cdot n^2 + c_1 \cdot n + c_0
$$
$$
\begin{bmatrix}
f(n) \\
f(n-1) \\
f(n-2) \\
\vdots \\
f(n-k+1) \\
(n+1)^2 \\
n+1 \\
1
\end{bmatrix}
=
\begin{bmatrix}
a_1 & a_2 & \cdots & a_{k-1} & a_k & c_2 & c_1 & c_0 \\
1 & 0 & \cdots & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & \cdots & 0 & 0 & 0 & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \vdots & \vdots \\
0 & 0 & \cdots & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & \cdots & 0 & 0 & 1 & 2 & 1 \\
0 & 0 & \cdots & 0 & 0 & 0 & 1 & 1 \\
0 & 0 & \cdots & 0 & 0 & 0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
f(n-1) \\
f(n-2) \\
f(n-3) \\
\vdots \\
f(n-k) \\
n^2 \\
n \\
1
\end{bmatrix}
$$
## 4.
$$
\begin{align}
f(n) &= a_{11}f(n-1) + a_{12}g(n-1) \\
g(n) &= a_{21} f(n-1) + a_{22} g(n-1)
\end{align}
$$
$$
\begin{bmatrix}
f(n) \\
g(n) \\
\end{bmatrix}
 =
\begin{bmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22} \\
\end{bmatrix}
\begin{bmatrix}
f(n-1) \\
g(n-1) \\
\end{bmatrix}
$$
## 要求：
矩阵系数不得含有 $n$ ，即 $a_1 \dots a_k$ 不得含有 $n$ ，否则无法**快速幂**。
## codeforce 719E:
完成
## next:
如果 $f(x)$ 和 $g(x)$ 可以递推
则 $f(x) \cdot g(x)$ 也可以线性递推。
$$
f(S) = \sum_{T\subseteq S} (\text{fib}(\sum_{t \in T}t)) ^ 2
$$
 $g(x) = \text{fib}(x)^2$ 则 
 $$
g(x) = 2g(x-1) + 2g(x-2) - g(x-3)
$$
$$
f(S) = \sum_{T \subseteq S} g(\sum_{t \in T} t)
$$
$$
\vec{G}(n)  =
\begin{bmatrix}
g(n) \\
g(n-1) \\
g(n-2)
\end{bmatrix}
=
\begin{bmatrix}
2 & 2 & -1\\
1 & 0 & 0\\
0 & 1 & 0\\
\end{bmatrix}
\begin{bmatrix}
g(n-1) \\
g(n-2) \\
g(n-3)
\end{bmatrix}
=
A^{n-2}
\begin{bmatrix}
g(2) \\
g(1) \\
g(0)
\end{bmatrix}
=
A^{n}
\underbrace{
\begin{bmatrix}
g(0) \\
g(-1) \\
g(-2)
\end{bmatrix}
}_{\vec{G}(0)}
$$

$$
\vec{F}(S) = \sum_{T \subseteq S} \vec{G}(\sum_{t\in T}t)
$$
$$
\vec{F}(S\cup a) = \vec{F}(S) + \underbrace{\overrightarrow{F}(\sum_{t\in T}t + a)}_{A^a\vec{F}(S)} = (I + A^a)\vec{F}(S)
$$
$$
\vec{F}(S) = \prod_{sub \in S}(I + A^{sub})\vec{G}(0)
$$
那么求
$$
\sum_{i = l}^{r}\sum_{j = i}^{r} f({a_i\dots a_j}) = \sum_{i = l}^{r}\sum_{j = i}^{r} \vec{F}({a_i\dots a_j}) = \sum_{i = l}^{r}\sum_{j = i}^{r} \prod_{k = i}^j(I + A^{a_k})\vec{G}(0)
$$
即求区间内所有子区间乘积的和，可以用分治解决。
## Luogu P6327:
由
$$
\sin(a_i + v) = \sin a_i \cos v + \cos a_i \sin v
$$
$$
\cos(a_i + v) = \cos a_i \cos v - \sin a_i \sin v
$$

$$
\begin{bmatrix}
\sin(a_i + v) \\
\cos(a_i + v) \\
\end{bmatrix}
 =
\begin{bmatrix}
\cos(v) & \sin(v) \\
-\sin(v) & \cos(v) \\
\end{bmatrix}
\begin{bmatrix}
\sin(a_i) \\
\cos(a_i) \\
\end{bmatrix}
$$
或者欧拉公式
$$
e^{ix} = \cos(x) + i \sin(x)
$$
$$
e^{i(x + v)} = e^{ix} \cdot e^{iv}
$$

## cf 1344F
观察到Mix操作实际上定义了 \[0-3\] 上的一个异或操作。
随后用
$$
W = 0 =
\begin{bmatrix}
0 \\
0 \\
\end{bmatrix}
,
R = 1 = 
\begin{bmatrix}
1 \\
0 \\
\end{bmatrix}
,
Y = 2 = 
\begin{bmatrix}
0 \\
1 \\
\end{bmatrix}
,
B = 3 =
\begin{bmatrix}
1 \\
1 \\
\end{bmatrix}
$$
$$
RY = 
\begin{bmatrix}
0 & 1 \\
1 & 0 \\
\end{bmatrix},
RB =
\begin{bmatrix}
1 & 0 \\
1 & 1 \\
\end{bmatrix},
YB = 
\begin{bmatrix}
1 & 1 \\
0 & 1 \\
\end{bmatrix}
$$
最后得到 $2k$ 个方程，bitset优化
ALL CLEAR