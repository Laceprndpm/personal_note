---
title: D2. Max Sum OR (Hard Version)
date: 2025-09-22
last_clear: 2025-09-23
tags:
  - tag/贪心
grasp: 2
value: 5
difficulty: 1900
optional_difficulty:
source: https://codeforces.com/contest/2146/problem/D2
article:
---
# 题意
## 大致题意
找到一个数组 `arr` ，使得 $\sum_{i = l}^{r} arr[i - l]\ |\ i$ 最大，其中 `|` 表示按位或
# Solution
对于 `l, r` 找到最高位 `t` ，使得 `l` 的 `t` 位为 `0` 而 `r` 的 `t` 位为 `1` 。令 `l` 或 `r` 的 `t` 位以上保留，`t` 位一下清空，得到 `x` ，其中 $l \le x \le r$ 。令 $x-1$ 配 $x$ ，$x-2$ 配 $x + 1$ 。以此类推，并递归的处理剩余部分，原因很直观：

1100
1011
1010
1001
1000
xxxx分界线xxxx
0111
0110
0101
0100

可以清楚的看到，这样配没有任何位被"浪费"掉。
## 

# 反思
## 赛时错解
注意到
1xxx
0xxx
如果分别解决了这两个问题，可以直接将后者平移到前者的位置，因为前面都是和0xxx在内部配的，所以高位1不会浪费。但是平移操作相当于让头碰头，尾碰尾，考虑刚刚好只有1000和0111的情况，则根本不会交换，极劣。
## 反思
没有场切，非常遗憾，除了当时状态不好，还犯了两个大忌：
1. 直接将D1思路带入而没有验证
2. 没有想清楚到底是如何进行分割，导致错误的思路也没快速的实现出来，从而发现错误
