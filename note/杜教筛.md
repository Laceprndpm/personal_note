---
title: 杜教筛
date: 2025-08-24
last_clear: 2025-08-24
tags:
  - summary
article: https://oi-wiki.org/math/number-theory/du/
---

# 定义
$$
\begin{align}
g(1)S(n)
= \sum_{i = 1}^n (f*g)(i) - \sum_{i = 2}^ng(i)S \left(\left\lfloor \frac{n}{i}\right\rfloor \right)
\end{align}
$$
例：
$$
\begin{align}
M(n) &= \sum_{i=1}^{n} \mu(i) \\
M(n) &= 1 - \sum_{i=2}^{n} M\left(\left\lfloor \frac{n}{i} \right\rfloor\right) \\
\end{align}
$$
$$
T(n) = T(\frac{n}{2}) + T(\frac{n}{3}) + \dots + T(1)
$$
约 $O(n^{\frac{3}{4}})$ ，若预处理前 $n^{\frac{2}{3}}$ 内容，则降到 $O(n^{\frac{2}{3}})$ 

## 证明：
$g(d)f\!\left(\tfrac{i}{d}\right)$ 就是对所有 $i \leq n$ 的做贡献，因此变换枚举顺序，枚举 $d, \tfrac{i}{d}$ （分别对应新的 $i,j$）

$$
\begin{align}
\sum_{i=1}^n \sum_{d \mid i} g(d) f\!\left(\tfrac{i}{d}\right)
= \sum_{i=1}^n \sum_{j=1}^{\lfloor n/i \rfloor} g(i) f(j) \\
= \sum_{i=1}^n g(i) \sum_{j=1}^{\lfloor n/i \rfloor} f(j) \\
= \sum_{i=1}^n g(i) S\!\left(\left\lfloor \tfrac{n}{i} \right\rfloor\right)
\end{align}
$$
则可以得到递推式
$$
\begin{align}
g(1)S(n) &= \sum_{i = 1}^{n}g(i)S\left( \left\lfloor \frac{n}{i} \right\rfloor \right) - \sum_{i = 2}^{n}g(i)S \left( \left\lfloor \frac{n}{i}\right\rfloor \right) \\[14px]
&= \sum_{i = 1}^n (f*g)(i) - \sum_{i = 2}^ng(i)S \left(\left\lfloor \frac{n}{i}\right\rfloor \right)
\end{align}
$$

假如我们可以构造恰当的数论函数 $g$ 使得：
1. 可以快速计算 $\sum_{i = 1}^{n} (f*g)(i)$ ;
2. 可以快速计算 $g$ 的前缀和，以用整除分块来求解
则可以使用杜教筛。
## 注意
无论数论函数 $f$ 是否为积性函数，只要可以构造出恰当的数论函数 ![](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "g"), 便都可以考虑用杜教筛求 $f$ 的前缀和。
如考虑 $f(n)=\mathrm{i}\varphi(n)$, 显然 $f$ 不是积性函数，但可取 $g(n)=1$, 从而：
$$
\sum_{k=1}^n (f*g)(k)=\mathrm{i}\frac{n(n+1)}{2}
$$
计算 $\sum_{k\leq m} (f*g)(k)$ 和 $\sum_{k \leq m} g(k)$ 的时间复杂度均为 $O(1)$ , 故可以考虑使用杜教筛。
## 时间复杂度
略
#todo/杜教筛