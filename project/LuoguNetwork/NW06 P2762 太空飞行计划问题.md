---
title: P2762 太空飞行计划问题
date: 2025-09-21
last_clear: 2025-09-21
tags:
  - tag/图论/网络流/最小割
grasp: 3
value: 4
difficulty:
optional_difficulty: 省选/NOI−
source: https://www.luogu.com.cn/problem/P2762
article: https://www.cnblogs.com/ticmis/p/13211073.html
article1: https://www.luogu.com.cn/problem/solution/P2762
---
最小割的典型应用，即当选择一个前驱节点时后继节点必须被选择

---
以下内容引用自luogu
#### 考虑证明：

(部分证明内容参考[CaptainChen的博客](https://blog.csdn.net/can919/article/details/77603353))

##### 先证明得到的子图是闭合的：

首先考虑由于求得是最小割，一个点要么和 s 相连，要么和 t 相连，否则一定割掉它向 s 或 t 的一条边是没有意义的，因为割掉该边不会改变图的不连通性，最小割不会割掉它。

由于原图中的边全部是正无穷，最小割只会割掉源点和正权点之间或负权点和汇点之间的边。

考虑如果选择了正权点 u，为了保证 s−t 不连通，必须割掉 u 所有后继中的负权点。这证明了如果选择了一个正权点那么所有的后继负权点都会被选择。

如果选择了正权点 u，设 v 是 u 的后继且 v 的的权值为正，由于没有割掉 u，通过 u−v 之间的正无穷边总能使得 s−v 联通，于是割掉 s−v 的边是没有意义的，最小割不会割掉这条边，这证明了如果选择了一个正权点那么该点的所有后继正权点都会被选择。

点权为 0 的情况同理。

考虑事实上选择的闭合子图的过程是不可能从一个负权点开始的，因为去掉这个负权点直接选择它的后继显然优于选择该点。于是只考虑选择正权点就可以包括所有的情况。证毕。

##### 再证明得到的是最大权子图：

考虑如果 i 与 s 联通，那么选择 i，否则不选择 i。所以最小割割掉的权值和是 不被选择的正权点权值和 + 被选择的负权点的权值的绝对值和 ，即 最小割 = min{没被选择的正权点权值和 + 被选择的负权点的权值的绝对值和}

于是

最大权闭合子图的权值和 = max{被选择的点权和} = 正点权和−min{没被选择的正权点之和 + 被选择的负权点绝对值和} = 正点权和−最小割

证毕。

于是本题只需要按照上述方法建图即可。输出方案只需要输出与 s 联通的点。

---
