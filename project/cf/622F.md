---
title: https://www.cnblogs.com/lfri/p/11556156.html
date: 2025-08-15
last_clear: 2025-08-15
tags:
  - tag/math/拉格朗日插值
  - tag/math/多项式和生成函数
grasp: 1
difficulty: 2600
source: https://codeforces.com/contest/622/problem/F
article: https://www.cnblogs.com/lfri/p/11556156.html
---
# 题意
$$
\sum_{i = 1}^{n} i^k \mod 1e9 + 7
$$
# Solution
因为最高次项为 $i^k$ ，且由 $i^k$ 累加而来。
$$
f(n) = \sum_{i = 1}^{n} i^k
$$
猜测为 k + 1 次多项式
$$
\begin{align}
k &= 0 \quad f(n) = n \\
k &= 1 \quad f(n) = \frac{n(n+1)}{2} \\
k &= 2 \quad f(n) = \frac{n(n+1)(n+2)}{6} \\
\end{align}
$$
==下面为延伸，听不懂也没关系==
$$
n^m = \sum_{k = 0} ^m \left\{ \begin{array}{c} m \\ k \end{array} \right\} n^{\underline{k}}
$$
$$
f(n) = \sum_{i = 1}^n i^k = \sum_{i = 1}^n\sum_{j = 0}^k \left\{ \begin{array}{c} m \\ k \end{array} \right\} i^{\underline{k}} = \sum_{j = 0}^k\left\{ \begin{array}{c} m \\ k \end{array} \right\} \sum_{i = 1}^n i^{\underline{k}}
$$
由
$$
\Delta \left(\frac{i^{\underline{k+1}}}{k+1}\right) = \frac{(i+1)^{\underline{k+1}} - i^{\underline{k+1}}}{k+1} = i^{\underline{k}} \implies \sum_{i=1}^n i^{\underline{k}} = \frac{(n+1)^{\underline{k+1}}}{k+1}
$$
==正片开始==
但是如果求第二类斯特林数的1e6范围，较为困难，但我们可以利用其是k + 1 次多项式的性质，用**拉格朗日插值**即可。
求出
$$
f(1),\;f(2) \dots f(k + 1)
$$
前 k + 2 项，可以在 $O(k \log k)$ 内求解。
随后在特殊情况二中，以 $O(k)$ 求解。
```c++
void solve()
{
    int n, k;
    cin >> n >> k;
    vector<Z> val(k + 3);
    for (int i = 1; i <= k + 2; i++) {
        val[i] = power(Z(i), k);
    }
    vector<Z> f_i(k + 3);
    for (int i = 1; i <= k + 2; i++) {
        f_i[i] = f_i[i - 1] + val[i];
    }
    if (n <= k + 2) {
        cout << f_i[n] << '\n';
        return;
    }
    Z wi = 1;
    for (int i = 1; i <= k + 2; i++) {
        wi *= (n - i);
    }
    Z ans = 0;
    for (int i = 1; i <= k + 2; i++) {
        ans += f_i[i] * (wi / (n - i)) / (comb.fac(i - 1) * comb.fac(k + 2 - i)) * ((k + 2 - i) % 2 == 0 ? 1 : -1);
    }
    cout << ans << '\n';
}
```
