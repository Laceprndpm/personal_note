---
title: D1. Diadrash (Easy Version)
date: 2025-11-27
last_clear: 2025-11-28
tags:
  - div2
  - tag/暴力
  - tag/贪心
grasp: 3
value: 4
difficulty: 2100
optional_difficulty:
source: https://codeforces.com/contest/2163/problem/D1
article:
---
```cpp showLineNumbers
int query(int l, int r)
{
    cout << '?' << ' ' << l << ' ' << r << endl;
    int res;
    cin >> res;
    return res;
}

void solve()
{
    int n, q;
    cin >> n >> q;
    vector<pair<int, int>> vec;
    for (int i = 0; i < q; i++) {
        int a, b;
        cin >> a >> b;
        vec.pb({a, b});
    }
    int mid    = (n + 1) / 2;
    int midval = query(1, mid);
    int ans    = 0;
    if (midval != 0) {
        // lft
        sort(all(vec), [](auto a, auto b) {
            if (a.fi == b.fi) {
                return a.se > b.se;
            }
            return a.fi < b.fi;
        });
        int last_r = 0;
        for (auto [l, r] : vec) {
            if (l > mid) {
                continue;
            }
            if (r <= last_r) continue;
            last_r  = r;
            int res = query(l, r);
            ans     = max(ans, res);
        }
    } else {
        sort(all(vec), [](auto a, auto b) {
            if (a.se == b.se) {
                return a.fi < b.fi;
            }
            return a.se > b.se;
        });
        int last_l = n + 1;
        for (auto [l, r] : vec) {
            if (r <= mid) {
                continue;
            }
            if (l >= last_l) continue;
            last_l  = l;
            int res = query(l, r);
            ans     = max(ans, res);
        }
    }
    cout << '!' << ' ' << ans << endl;
}

```
引理：
1. 对于 $l \in [1, n]$ ，可以贪心地选择其最大的 $r \in [1, n]$ ，因此当父区间优于子区间时，最多有 $n$ 个有效区间。
本题中是取 $MEX \{arr[l]..arr[r]\}$ ，分区间一定优于子区间，因此可以直接通过一次询问确认0的位置，随后可以直接剪枝掉 $l > mid$ 或 $r < mid$ 的情况。
