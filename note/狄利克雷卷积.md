---
title: 狄利克雷卷积
date: 2025-08-24
last_clear: 2025-08-24
tags:
  - summary
article:
---

# 定义
$$
\boxed{
\begin{aligned}
&\text{For all } n, \quad h(n) = \sum_{d \mid n} f(d)\, g\left( \frac{n}{d} \right) \\
&\text{Equivalent to:} \\
&\quad \text{for } d \text{ in range}(1, n + 1): \\
&\quad\quad \text{for } j \text{ in range}(1, \left\lfloor \frac{n}{d} \right\rfloor + 1): \\
&\quad\quad\quad h(d \cdot j) \mathrel{+}= f(d) \cdot g(j)
\end{aligned}
}
$$
$$
\boxed{
\begin{aligned}
(f*g)(n) = \sum_{d \mid n} f(d)\, g\left( \frac{n}{d} \right) 
\end{aligned}
}
$$
# 性质
若 $f(n), g(n)$ 为积性函数，则 $f*g$ 为积性函数
若 $f(n)$ 积性函数，则  $g(n) = \sum_{d|n}f(n)$ 也是积性函数（$g(x) = 1$ 的特例）
$$
\boxed{
\begin{align}
\varepsilon &= \mu * 1 \\
\mathrm{id} &= \varphi * 1 \\
\varphi &= \mu * \mathrm{id}
\end{align}
}
$$
设 $a \in \{1,2,\dots,n\}$，则 $\gcd(a,n)$ 必为 $n$ 的因数。  
分类统计所有 $\gcd(a,n) = d$ 的 $a$ 有多少个:
令 $a = d \cdot k$，则 $1 \le k \le n/d$ 且 $\gcd(k, n/d) = 1$  
因此这类 $a$ 的个数为 $\phi(n/d)$。
所有可能的 $\gcd(a,n)$ 构成划分，故:
$$
n = \sum_{d \mid n} \phi(n/d)
$$
得:
$$
\boxed{\mathrm{id} = \phi * 1}
$$
