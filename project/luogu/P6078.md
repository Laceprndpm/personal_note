---
title: "[CEOI 2004] Sweets"
date: 2025-08-13
last_clear: 2025-08-13
tags:
  - tag/计数/容斥
  - tag/math/多项式和生成函数
grasp: 2
difficulty: 2300
source: https://www.luogu.com.cn/problem/P6078
article:
---
同[[451E]]，可得到 $O(b-a) n \cdot 2^n$ 的解法
但对于最后一步
$$
\sum_{s = a}^b \sum_i[x^i]A(x) \cdot \binom{s-i + n - 1}{n - 1} = \sum_i[x^i]A(x) \sum_{s = a}^b \binom{s-i + n - 1}{n - 1}
$$
化简成:
$$
\sum_i[x^i]A(x) \left(\binom{b-i + n}{n} - \binom{a-i + n - 1}{n} \right)
$$
这里还需要注意2004不是质数，所以需要额外操作，具体的
```c++
Z sp_binom(i64 n, i64 m)
{
	if (n < 0 || m < 0) return 0;
	assert(m <= 30);
	i64 mod = P;
	for (int i = 1; i <= m; i++) {
		mod *= i;
	}
	i64 ans = 1;
	for (i64 i = 0; i < m; i++) {
		ans *= (n - i);
		ans %= mod;
	}
	for (int i = 1; i <= m; i++) {
		ans /= i;
	}
	return ans;
}
```
