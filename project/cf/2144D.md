---
title: D. Price Tags
date: 2025-09-16
last_clear: 2025-09-16
tags:
  - tag/math/分块
grasp: 3
value: 5
difficulty: 1600
optional_difficulty:
source: https://codeforces.com/contest/2144/problem/D
article:
---
# 题意
Imagine that you are the owner of a store. Before the start of a new season, you decided to clear your store of leftover goods, and therefore you decided to hold a total sale. You have $n$ different items in your store: the $i$\-th item costs $c_i$ coins. Each item has a price tag with the corresponding price $c_i$. You decided to hold a sale in the format: "we divided all the prices $x$ times." Formally, this means that you choose a common coefficient $x$, and during the sale, the $i$\-th item will cost $\left\lceil \frac{c_i}{x} \right\rceil$ coins (where $\left\lceil y \right\rceil$ denotes rounding up). To avoid confusion among the customers, you need to pin new price tags with new prices on all items, but printing new price tags is costly. Specifically, each printed price tag will cost you $y$ coins. Therefore, you had a brilliant idea — why not use the existing price tags and simply repin them on other items? So, you'll need to print price tags only for those items that do not have a corresponding price tag available. There remains one last question: by how much should you reduce the prices, or what $x$ should you choose? The coefficient $x$ must be an integer **strictly greater** than $1$ and such that the total income is maximized. The total income is equal to the total value of the items minus the cost of the printed price tags. Determine the maximum possible total income.
## Input 
The first line contains a single integer $t$ ($1 \le t \le 10$) — the number of test cases. The first line of each test case contains two integers $n$ and $y$ ($1 \le n \le 2 \cdot 10^5$; $1 \le y \le 10^9$) — the number of items and the cost of printing one price tag. The second line contains $n$ integers $c_1, c_2, \dots, c_n$ ($1 \le c_i \le 2 \cdot 10^5$) — the initial prices of the items.
## Output
For each test case, output a single integer — the maximum total income.
# Solution
## my分块
开始时错误方法：
```cpp
    // 大概和数论分块有关
    // 我可以对每个物品进行一次数论分块
    // 分块什么？
    // 我可能会获得42 : 2 * 21 3 * 14...
    // 我想要什么？当他的价格是x时，有哪些物品也是x。
    // 当 x <= sqrt(ai)，x少
    // 当 x >= sqrt(ai)，似乎只有sqrt(n) * n个有效点...?
    // 能不能滑动窗口？假设我已经知道ci减1，di加一个
    // 当 x>= sqrt(ai)，
    //
    // 好像可以直接滑动窗口
```
这里虽然 $n \sqrt{n} \times 10 = 8,9442,7190 \approx 9e8$ 看似不会超时，但空间复杂度 $n\sqrt{n} =  8944,2719 \approx 9e7$ 超过了内存上限。且常数稍微